---
title: "index"
author: "Sheng Cao & Xiaolin Zheng"
date: "2/23/2022"
output: html_document
---

[hyperlink](http://cgss.ruc.edu.cn/English/Home.htm)

```{r warning=FALSE}
library(tidyverse)
library(naniar)
library(haven)
library(ggthemes)
```

```{r warning=FALSE}
raw_data <- read_dta("cgss2015_14.dta")
```

# Part I. Data, Variable and Method
Among the many factors that affect the quality of life of the elderly, health has always played an important role. Traditionally, health mainly refers to the soundness of physiological functions, whereas the modern interpretation of health has a richer connotation. In 1946ï¼Œthe World Health Organization (WHO) defined health as "a state of complete physical, mental, and social well-being". Therefore, only by exploring health stauts from multiple perspectives can we better understand and improve the health condition of the elderly.

We use China General Social Survey (CGSS) 2015 to find demographic characteristics and variables associated with differences in health levels of the elderly.

We selected several related variables. For demographic characteristics variables, we choose "age" (and define the elderly as people over 60 in 2017 according to WHO criteria), "sex" (male is assigned "1" and female "2"), "marital status" ("1" means not single, "0" means single), "whether the respondent has kids" ("1" means yes, "0" means no), and "education year" ("1" means has no education at all......"13" means graduate or above).

We measure health levels of the elderly from three dimensions.The first is self-rated health. Self-rated health is a good indicator of a respondent's overall health information.In CGSS 2017, respondents were asked, "How do you feel about your current physical health?" Responses are in five categories, in order of "very unhealthy," "relatively unhealthy," "fair," "relatively healthy," and "very healthy", which were assigned values "1, 2, 3, 4, 5" in that order.

The second is mental health, where respondents were asked, "In the past four weeks, how often did you feel depressed or frustrated?" The responses are "always", "often", "sometimes", "rarely" and "never" and were assigned values 1 to 5.

For physical health, respondents were asked, "In the past four weeks, how often did health problems affect your work or other daily activities? " The responses were "always", "often", "sometimes", "rarely" and "never", and were assigned a value of "1 to 5" respectively.

We use descriptive statistics and reflect what we have in graphs.

```{r warning=FALSE}
data <- raw_data %>%
  select(a2, a15, a16, a17, a681, a682, a69, a301,a7a)
```

```{r warning=TRUE}
# rename the variable
data <- data %>%
  rename(
    "sex" = a2,
    "self_health" = a15,
    "phy_health" = a16,
    "mental_health" = a17,
    "n_son" = a681,
    "n_daughter" = a682,
    "marr_status" = a69,
    "yr_birth" = a301,
    "educ" =a7a
  )
```

```{r warning=FALSE}
# generate new variables
data <- data %>%
  mutate(
    age = 2015 - yr_birth,
    n_kids = n_son + n_daughter,
    marr_status = case_when(
      marr_status == 1 ~ "0",
      marr_status == 5 ~ "0",
      marr_status == 6 ~ "0",
      marr_status == 7 ~ "0",
      TRUE ~ "1"
    ),
    sex = if_else(
      sex == 1, "Male", "Female"
    )
  ) 
```

```{r}
data <- data %>%
#replace certain values to NA.
   replace_with_na_at(c("self_health", "phy_health", "mental_health"), condition = ~.x == -8) %>%
  replace_with_na_at(c("n_kids"), condition = ~.x == -16) %>%
  replace_with_na_at(c("educ"), condition = ~.x == 14)%>%
  replace_with_na_at(c("educ"), condition = ~.x == -8)
```
  
```{r warning=FALSE}
# filter the observations of interest
data <- data %>%
  filter(
    age >= 60
  )
```

# Part II. Data Visualization
## A. Difference of **Health Status between Sex for people over 60**

```{r warning=FALSE}
# Figure 01

  # Data manipulation
subdata1 <- data %>%
  group_by(age, sex) %>%
  summarize(
   mean_self = mean(self_health, na.rm = TRUE),
   mean_phy = mean(phy_health, na.rm = TRUE),
   mean_mental = mean(mental_health, na.rm = TRUE)
  )

  # create a panel label name
lab_names1 <- c(
  `mean_mental` = "Mental Health",
  `mean_phy` = "Physical Health",
  `mean_self` = "Self Rated Health"
)

  # Draw the graph
F1 <- subdata1 %>%
  pivot_longer(cols = c(mean_self, mean_phy, mean_mental), names_to = "health", values_to = "average") %>%
  ggplot(mapping = aes(x = age, y = average, colour = sex)) +
  geom_line() +
  facet_wrap(~health, labeller = as_labeller(lab_names1)) +
  scale_y_continuous(limits = c(1, 5))

  # Add labels and themes
F1 +
  labs(
    title = "The elder women have poorer health status",
    subtitle = "Average Health Scores by Sex",
    caption = "Source: Chinese General Social Survey 2015",
    x = "Age",
    y = "Average Score"
  ) + 
  theme_economist() +
  scale_color_economist(name = NULL) +
  theme(
    axis.title.x = element_text(margin = margin(5,0,0,0),
                                face = "bold"),
    axis.title.y = element_text(margin = margin(0,5,0,0),
                                face = "bold")
  )
```

With the increase of age, average self-rated health scores, average physical scores and average mental scores show a downward trend, indicating that health condition will get worse when people get older. In addition, we can notice that average health scores of elderly men are generally higher than those of elderly women at every age. In china, women take more family care-related responsibilities than men. As women get older, they are more likely to be less healthy physically and more stressful mentally. Therefore, our pension policy should more focus on elderly women health status, and improve the employment and society environment for the women.


## B. Health Status by Marriage Status

```{r warning=FALSE}
# Figure 02

  #Data manipulation
subdata2 <- data %>%
  select(marr_status, self_health, phy_health, mental_health) %>%
  group_by(marr_status) %>%
  mutate(
    marr_status = recode(marr_status,
      `0` = "Single",
      `1` = "Not single"
    )
  )

  # create a panel label name
lab_names2 <- c(
  `mental_health` = "Mental Health",
  `phy_health` = "Physical Health",
  `self_health` = "Self Rated Health"
)

  # Draw the graph
F2 <- subdata2 %>%
  pivot_longer(cols = c(self_health,phy_health,mental_health),names_to = "health", values_to = "healthscores") %>% 
  ggplot(mapping = aes(x = marr_status, y = healthscores, color = marr_status)) +
  geom_violin(alpha = 0.5,adjust= 1,scale = "area") +
  facet_wrap(~health, labeller = as_labeller(lab_names2))

  # Add lables and themes
F2 +
  labs(
    title = "Single aging population has lower health scores",
    subtitle = "Average Health Scores by Marriage Status",
    caption = "Source: Chinese General Social Survey 2015",
    x = "",
    y = "Health Scores"
  ) +
  theme_economist() +
  scale_color_economist(name = NULL) +
  theme(
    axis.title.x = element_text(margin = margin(5,0,0,0),
                                face = "bold"),
    axis.title.y = element_text(margin = margin(0,5,0,0),
                                face = "bold")
  )

```

We characterize those who have no partners who live with them as single and those who have the partner who live together as not single. We can conclude from the graph that those who have the partners are more likely to be healthier since more people among the Not single elderly have higher scores (4 and 5) in mental, physical and self-rated health. The difference among lower scores (3, 2 and 1) is not significant to see. So our pension policy should focus more on single aging population. Policymakers should implement series of laws to provide them with mental, physical health support.

